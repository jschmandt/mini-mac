\section{Introduction}
\label{intro}

At the 2015 Black Hat conference, Miller and Valasek~\cite{blackhat} gained full control of a new Jeep,
including its engine, brakes, and steering, by exploiting vulnerabilities in its
computer network and Wi-Fi implementation and by rewriting firmware on a controller connected to the car's entertainment system.
This demonstration, and other similar 
projects~\cite{Rouf2010,Koscher-2010,Checkoway-2011,Woo-14,C2X}, 
highlight the egregious state of vehicular security, including the lack of 
authentication of messages sent on the Controller Area Network (CAN).   

To strengthen vehicular security in a simple and practical 
yet meaningful way---without replacing the CAN bus---we propose Mini-MAC, 
a new variable-length Message Authentication Code (MAC)
for the CAN bus that works with small payload sizes without delaying messages.  
Built on the provably-secure HMAC, Mini-MAC protects against masquerade attacks.  
Mini-MAC also incorporates a counter and message history to protect against replay attacks;
the message history feature protects against all transient attackers (attackers
who can access the CAN bus only for a limited period of time).
To avoid sending separate messages to different recipients, Mini-MAC applies authentication keys
shared among groups of communicating Electronic Control Units (ECUs).
It is the first proposal to authenticate messages on the CAN bus without increasing bus traffic
or delaying messages. 

Traditional authentication protocols (including digital signatures or full-length MACs) are unsuited for the CAN bus due to
small packet size, limited computational power of the ECUs,
and the need not to delay messages (e.g., by time-consuming computations or by
increasing bus traffic).   

Mini-MAC improves on previous proposals, including Lin-MAC~\cite{Lin-MAC}, by not increasing bus traffic.
Furthermore, Mini-MAC is easy to implement,
requires no fundamental change to the underlying functionality of the ECUs, and 
requires no special hardware.

Our work includes a prototype implementation of Mini-MAC and preliminary timing studies 
of Mini-MAC for three component hash functions (MD5, SHA-1, SHA-2).  
In comparison with a straight-forward HMAC, our Mini-MAC implementations show on average
a mean code size increase of 5.99\% and 
a mean execution time increase of only 2.58\%.
For fastest speeds, we recommend using mini-MAC-MD5, for which our implementation 
running on an 8~MHz processor takes on average 7.5~ms to compute a tag.

Our contributions include:
\begin{itemize}

\item Mini-MAC, an authentication protocol suitable for many vehicular systems, including the CAN bus, 
that require short message sizes and no message delays.
Mini-MAC meaningfully raises the bar on authentication strength for the CAN bus, protecting against
masquerade and replay attacks.

\item Mini-MAC's use of message history protects against all transient attackers, 
even if they know the keys.

\item Experimental demonstration of Mini-Mac, including execution times of Mini-MAC 
with each our three HMAC implementations using the MD5, SHA-1, and SHA-2 hash functions. 
On average our implementation of Mini-MAC-MD5 takes 7.5~ms to compute a tag.

\end{itemize}
