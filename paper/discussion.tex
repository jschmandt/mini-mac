\section{Discussion}
While Mini-MAC succeeds in securing the CAN bus against replay and masquerade attacks from time-limited attackers, it is possible to further improve automotive security through more involved protocol and network architecture changes. These changes are more difficult and more costly to implement, but offer far better protection. 

\subsection{Adding Bits to Mini-MAC}
Although 27.3 minutes average time-to-defeat for a brute force attack may be entirely sufficient for the context of a moving automobile, it is always worth exploring raising that number. Against a brute force attack the solution is simply more bits in the MAC, which as discussed, is not possible without adding bus overhead at the application level. 

It is possible to add two more bytes to the transmitted MAC by replacing the CRC field (2 bytes, figure 1) with MAC bits. The MAC will provide the feature of checking for message error (so long as the underlying hash is collision-free) in addition to authentication.
	
The difficulty here is in rewriting lower-level code such as firmware or drivers (depending on ECU) to either perform the entire MAC calculation or to open the CRC field up to the application level which calculates the MAC. The defense time gains from the additional two bytes can be extremely significant. Table 4 shows how the brute force time-to-beat changes for different lengths of the MAC. Bits are represented by b in Table 4. Any MAC smaller than 4B is probably useless, but in the case of a 5B or 6B MAC, the brute force attacker will very likely run out of time. The 6B MAC, which accounts for the original 4B plus the 2B from the CRC field, is capable of holding out against even an attacker with an extended time budget (for example, if you leave your car on the street and leave for the weekend).

	\begin{table}	
	\centering
	\begin{tabular}{|c|c|}\hline%
	\bfseries MAC Length(b) & \bfseries Time-to-Defeat\\\hline \csvreader[late after line=\\]%
		{tables/maclen_bfttb.csv}{mac_len=\mac_len,ttb=\ttb}% 
		{\mac_len & \ttb}%
		\hline
	\end{tabular}
	\vspace{11pt}
	\caption{Time-to-Defeat for Various MAC Lengths}
	\end{table}

\subsection{Design Alternatives}
The capabilities of the CAN bus and the ECUs on it are the limiting factors in how secure it can be made. There are two major design changes to automotive computer networks that would significantly increase security: 1) Replace CAN with high-speed, well defined network stack elements such as 802.3 Ethernet and IP 2) Segregate nodes on the CAN bus into task-defined groups.

As info-tainment becomes a major task of the modern automotive computer network, these networks must be able to support not only control information but high rate audio and video content. The Ethernet/IP stack found in many home networks is a natural fit for this task. Additionally, these networks can utilize IPsec, which can handle data encryption and authentication.

That a car radio could potentially send a message to a brake control unit is a tremendous oversight in design. Although some vehicles do a better job of segregating vehicle control units from entertainment or environment control units than others, there is no standardization and these design decisions seem to stem more from spatial arrangment or bus availablilty than they do for any security-conscious reason.


\subsection{Open Problems}
There is a relevant open problem related to this work which can be framed by asking the question ``How effective are hash functions over small messages?" As previously noted, the messages on the CAN bus are 8B, and before any practical use of a solution like Mini-MAC could be made, this question must be answered to a satisfying degree. Many practical hash implementations require padding of inputs to fit fixed size inputs, but what ratio of padding to message is acceptable before the hash loses effectiveness? These are not questions unique to Mini-MAC, but it is a protocol which could be severly compromised from a hash which is weak under heavy padding as the message is so small compared to the input block size.

%Lin-MAC claims to implement a suitable key distribution infrastructure and counter resynchronization mechanism that is suitable for implementation on ECUs on the CAN bus. Before any system becomes practically implementable, these claims must be verified.