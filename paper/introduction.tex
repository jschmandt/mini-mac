\section{Introduction}
Note to ed: I haven't re-done the intro yet. I want to get the rest of the paper in good shape before working on it.

The Controller Area Network (CAN) bus is typically used in automotive networks to connect various ECUs in the vehicle. These ECUs can control anything from electronic door locks to the brakes or engine. With the advent of ``drive-by-wire" systems in vehicles that offload tasks that previously required physical driver interaction (for example, ignition, steering, or braking) to semi-autonomous systems, the ECUs in a vehicle are tasked with actually driving the vehicle more and more.

This new paradigm in automotive control presents an obvious target to malicious actors who wish to gain control over a car. Such access poses a direct threat to the safety of the people in the car and other drivers on the road. The CAN bus provides no security layer and is not suitable for use with traditional security measures \cite{Koscher-2010}\cite{Checkoway-2011}. To this end, this project presents a security solution designed for message authentication in a constrained environment such the CAN bus, which is the first solution designed to authenticate bus messages without adding any message traffic overhead. 

The threat to the network stems from the broadcast nature of the CAN bus -- any message put on the bus can be sent from any ECU, and only a non-verified ID field is used to discriminate between senders. The lack of authentication allows malicious actors to cause invalid messages to be accepted by ECUs simply by spoofing their ID or by replaying messages seen earlier.

A traditional solution to this vulnerability is message authentication which requires the use of a secret key to create a verification value the recipient can use to verify the sender did indeed generate the message. Simple MACs do not prevent replay attacks as a malicious actor can simply resend a message seen before if they wish to recreate the behavior (for example, the use of brakes). Time-seeded MACs use some time-based token to prevent replay attacks by issuing a new MAC for the same message at a different time.

Traditional cryptography is also unsuitable for use in automotive networks for several reasons. Primarily, the computing resources required for full encrypt/decrypt operations are unrealistic for the type of embedded computer found in automobiles. Additionally, the messages generated by traditional symmetric ciphers (asymmetric cryptography is not considered, being much more computationally instensive than symmetric cryptography) such as AES will not fit into a single CAN frame and would therefore significantly increase bus traffic.

Another concern with the CAN bus is that many of the messages concern the real-time operation of ECUs which control critical car components such as the brakes or engine. Not only must a security measure be suitable for execution on computationally weak devices, but it must not incur a bus utilization penalty for fear of violating any real-time constraints which could have dire safety implications for the driver or other people on the road.

The attacks concerned are more specifically called replay and masquerade attacks. In a replay attack, an illegitimate node propagates a previously observed message on the bus in hopes of re-creating a desired response, also previously observed. In a masquerade attack, the illegitimate node propagates either a new or previously observed message with the intent of appearing to be a legitimate sender.



%Encryption and decryption may suit the message size requirements, but these operations are typically computationally intense, and are unsuitable for running on ECUs that must operate in real-time or near real-time.

Lin-MAC suggests a MAC computed with a counter, which is incremented on every message. This solves the replay attack problem, but it does not address some of the other issues with a MAC, namely that 1) the sender must generate a new MAC for each recipient and B) the sending of a MAC along with a message takes far too much bus time to be useful in a time-constrained system \cite{Lin-MAC}.

To address these concerns, this project presents Mini-MAC, which is designed not to increase bus utilization at all. Mini-MAC adaptively sizes the MAC result depending on which message is being sent. It also operates on the premise of grouped keys, rather than a pairwise key system. It also incorporates message history into the construction of the MAC which adds a layer of confusion to the resulting authentication value. It is the first protocol to authenticate automotive network messages without adding bus utilization overhead.

Specifically, this project presents several contributions:
\begin{itemize}
\item Mini-MAC, a small-size authentication protocol suitable for systems like the CAN bus
\item A partial redesign of the CAN protcol which would enable stronger authentication Note to ed.: This isn't necessary for Mini-MAC to work but it would make it stronger - I don't want the reader to think that the system won't work without modifying the underlying CAN protocol
\item A discussion on context-dependent security for automotives Note to ed.: what I want to mention is the idea that security is not a binary option, and that for a context like this, it may be suitable to have a system that will prevent attacks for a short time period. I'm not sure the best way to summarize that.
\end{itemize}

The end goal for security is usually to make it too expensive (in terms of time, computing resources, or otherwise) for an attacker to defeat the defensive measures in place, be it standard cryptography or a low-overhead MAC protocol such as this work. The key difference between this work and traditional network security is an attack budget dominated by the very short time available to the attacker. With that in mind, it is possible to design a security mechanism that is capable of defending the network on that very short scale of time without breaking real-time or processing capability constraints.